<table id="navigaa">
    <tr>
        <td>
            <h3><%= link_to("FTC Teams Search",teams_path, class: 'pure-button pure-button-primary nav-link full-width') %>
            </h3>
            <h3><%= link_to("Map Search","map", class: 'pure-button pure-button-primary nav-link full-width') %>
            </h3>
        </td>
        <td>
            <h3><%= link_to("Event Search",events_path, class: 'pure-button button-primary nav-link full-width') %>
            </h3>

            <h3><%= link_to("Global Top Scorers","stats/highscores", class: 'pure-button button-purple nav-link full-width') %>
            </h3>
        </td>
    </tr>
</table>
<ol id="navigaaa">
    <li><%= link_to("FTC Teams Search",teams_path, class: 'pure-button pure-button-primary nav-link') %>
    </li>
    <li><%= link_to("Map Search","map", class: 'pure-button pure-button-primary nav-link') %>
    </li>
    <li><%= link_to("Event Search",events_path, class: 'pure-button button-primary nav-link') %>
    </li>
    <li><%= link_to("Global Top Scorers","stats/highscores", class: 'pure-button button-purple nav-link') %>
    </li>
</ol>

<script>
    window.mobilecheck = function () {
        var check = false;
        (function (a) {
            if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4)))
                check = true;
            }
        )(navigator.userAgent || navigator.vendor || window.opera);
        return check;
    };
</script>

<div id="container">
    <center>
        <div id="data-container">
            <h1>
                FTC Team Finder
            </h1>
            <h5><%= link_to("Search by team name/id instead", teams_path,:class=>"pure-button button-secondary nav-link") %></h5>
            <div id="data-info">
                <h3 id="data-teamname">
                    Click on a marker to begin</h3>
            </div>
        </div>
    </center>
    <div id="map-container">
        <input id="pac-input" class="controls" type="text" placeholder="Enter City or Zipcode">
        <div id="map">
            <h1>LOADING</h1>
        </div>
    </div>
    <div>
        <p>
            If any information is incorrect, contact
            <%= link_to("meeee","mailto:help@ftcroot.com") %></p>
        <p>
            Also the locations are approximations based off of zipcode
        </p>
    </div>

</div>

<script>
    var geocoder;
    var map;
    var markers = [];
    var realIndex = 0;
    var didinit = false;
    $("#navigaaa").hide();
    $(document).on('turbolinks:load', function () {

        if (!didinit) {
            initialize();
            didinit = true;
        }
        if (mobilecheck()) {
            $("#container").hide();
            $("#navigaaa").show();
            $("#navigaa").hide();
            console.log("HI");
        }

    });
    function initialize() {
        geocoder = new google.maps.Geocoder();
        var center = new google.maps.LatLng(37.9990858, -100.98347380000001);
        console.log(map);
        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 5,
            center: center,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        // Create the search box and link it to the UI element.
        var input = document.getElementById('pac-input');
        var searchBox = new google.maps.places.SearchBox(input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
        map.addListener('bounds_changed', function () {
            searchBox.setBounds(map.getBounds());
        });
        searchBox.addListener('places_changed', function () {
            var places = searchBox.getPlaces();

            if (places.length == 0) {
                return;
            }
            var bounds = new google.maps.LatLngBounds();
            places.forEach(function (place) {
                if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                }
                if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                } else {
                    bounds.extend(place.geometry.location);
                }
            });
            map.fitBounds(bounds);
        });
        var infowindow = new google.maps.InfoWindow();
        var mak;
        var e;
        <% @hello.each do |team| %>
        mak = new google.maps.Marker({
            map: map,
            position: new google.maps.LatLng(<%= team.location_lat %>, <%= team.location_long %>),
            title: "<%= team.name %>",
            address: "<%= team.location %>",
            id: "<%= team.id %>"
        });
        markers.push(mak);
        <% end %>
        for (var i = 0; i < markers.length; i++) {
            mak = markers[i];
            mak.addListener('click', (function (makr) {
                return function () {
                    $.ajax({
                        url: "/teams/" + makr.id + "/plain?showlink=true",
                        cache: false,
                        success: function (html) {
                            $("#data-info").html(html);
                        }
                    });
                    realIndex = makr.id;
                    //   console.log(i);
                }
            })(mak));
        }
        var options = {
            imagePath: 'images/m',
            maxZoom: 8
        };
        var markerCluster = new MarkerClusterer(map, markers, options);
    }
</script>

<style >
    #container {
        /*display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      justify-content: space-between; */
        /*background-color: lightyellow;*/
        min-height: 600px;
    }
    #map-container {
        padding: 6px;
        border-width: 1px;
        border-style: solid;
        border-color: #ccc #ccc #999 #ccc;
        -webkit-box-shadow: rgba(64, 64, 64, 0.5) 0 2px 5px;
        -moz-box-shadow: rgba(64, 64, 64, 0.5) 0 2px 5px;
        box-shadow: rgba(64, 64, 64, 0.1) 0 2px 5px;
        /*min-width: 500px;*/
        width: 100%;
        /*width: 500px;*/
        /*max-width: 500px;*/
        height: 600px;
        /*display:inline-block;*/
    }
    #data-container {
        /*width:100%;*/
        /*height:100%;*/
        /*margin: 10px;*/
        /*display:inline-block;*/
        /*min-width: 300px;*/
        /*min-height: 600px;*/
    }
    #map {
        /*height: calc(100%-10px);*/
        height: 585px;
        width: calc(100%);
    }
    .controls {
        margin-top: 10px;
        border: 1px solid transparent;
        border-radius: 2px 0 0 2px;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        height: 32px;
        outline: none;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    }

    #pac-input {
        background-color: #fff;
        font-family: Roboto;
        font-size: 15px;
        font-weight: 300;
        margin-left: 12px;
        padding: 0 11px 0 13px;
        text-overflow: ellipsis;
        width: 300px;
    }
    #pac-input:focus {
        border-color: #4d90fe;
    }

    .pac-container {
        font-family: Roboto;
    }

    #type-selector {
        color: #fff;
        background-color: #4d90fe;
        padding: 5px 11px 0;
    }

    #type-selector label {
        font-family: Roboto;
        font-size: 13px;
        font-weight: 300;
    }
    #target {
        width: 345px;
    }

</style>
