<table id="navigaa">
    <tr>
        <td>
            <h3><%= link_to("Teams Search",teams_path, class: 'pure-hover pure-button pure-button-primary nav-link full-width') %>
            </h3>
            <h3><%= link_to("Event Search",events_path, class: 'pure-hover pure-button button-primary nav-link full-width') %>
            </h3>
            <h3><%= link_to("Region Search",regions_path, class: 'pure-hover pure-button button-red nav-link full-width') %>
            </h3>
        </td>
        <td>
            <h3><%= link_to("Game Rule Clarifications",'/search', class: 'pure-hover pure-button button-gray nav-link full-width') %>
            </h3>
            <h3><%= link_to("Global Top Scorers","stats/highscores", class: 'pure-hover pure-button button-purple nav-link full-width') %>
            </h3>
            <h3><%= link_to("Join our email blast",page_path("newsletter"), class: 'pure-hover pure-button button-gray nav-link full-width') %>
            </h3>
        </td>
    </tr>
</table>
<ul id="navigaaa">
    <li><%= link_to("Teams Search",teams_path, class: 'pure-hover pure-button pure-button-primary nav-link') %></li>
    <li><%= link_to("Event Search",events_path, class: 'pure-hover pure-button button-primary nav-link') %></li>
    <li><%= link_to("Region Search",regions_path, class: 'pure-hover pure-button button-red nav-link') %></li>
    <li><%= link_to("Game Rule Clarifications",'/search', class: 'pure-hover pure-button button-gray nav-link full-width') %></li>
    <li><%= link_to("Global Top Scorers","stats/highscores", class: 'pure-hover pure-button button-purple nav-link') %></li>
    <li><%= link_to("Join our email blast",page_path("newsletter"), class: 'pure-hover pure-button button-gray nav-link full-width') %></li>
</ul>
<%#= render 'events/live' %>

<div class="card">
    <div class="card-container">
        <h3> FTCRoot will end on December 1</h3>
        <p> (11/13/17) </p>
        <p> Thanks for using FTCRoot, it was a fun journey as the quest to obtain event data.</p>
        <p> In just under 2 months we were able to develop this website and begin collecting event data. And by the end of the season, with the help of mentors, FTC Affiliates, and students, we amassed almost the entire continental US with over 51 regions accounted for and 450+ events! <br/> It was a fun journey for us all!</p>
        <br/>
        <p> Thank you Bill Gardner (A.K.A. <%= link_to "Cheer4FTC", "https://twitter.com/CHEER4FTC" %>) for his dedication to FTC and helping consolidate all the event information <br/> and thanks to John Nguyen (<%= link_to 'FTCStats',"ftcstats.org" %>) and Ken Pugsley (<%= link_to 'MoFTCScores',"http://moftcscores.net/" %>) for their collaboration as well as everyone who has helped obtain event data!</p>

        <p> For now, if you want up to date events <%= link_to "The Orange Alliance", "https://theorangealliance.org/home" %> should be your go to central site! Thanks to Alex Fera for taking the reigns and making an even better site! </p>
        <p> We'll be helping make The Orange Alliance the best so go check it out! </p>

        Btw. THe only updated part of the website for 2018 is Game rule clarifications! Check it out :P

        <p>This site and the 2017 velocity vortex game will still be forever housed on <%= link_to "http://ftcroot.herokuapp.com","http://ftcroot.herokuapp.com" %></p>
        <center><b><p>--- Kevin Fang (TheReddKing) <br/>
        ChaosMonkeyz 11090</p></b></center>
    </div>
</div>
<br/>

<div id="container">
    <center>
        <div id="data-container">
            <h1>
                Team Finder
            </h1>
            <div id="data-info">
                <h3 id="data-teamname">
                    Click on a marker to begin</h3>
            </div>
        </div>
    </center>
    <div id="map-container">
        <input id="pac-input" class="controls" type="text" placeholder="Enter City or Zipcode">
        <div id="map">
            <h1>LOADING</h1>
        </div>
    </div>
    <div>
        <p>
            If any information is incorrect, contact
            <%= link_to("meeee","mailto:help@ftcroot.com") %></p>
        <p>
            Also the locations are approximations based off of zipcode
        </p>
    </div>

</div>

<script>
    var geocoder;
    var map;
    var markers = [];
    var realIndex = 0;
    var didinit = false;
    $("#navigaaa").hide();
    $(document).on('turbolinks:load', function () {

        if (!didinit) {
            initialize();
            didinit = true;
        }
        if (mobilecheck()) {
            $("#container").hide();
            $("#navigaaa").show();
            $("#navigaa").hide();
            console.log("HI");
        }

    });
    function initialize() {
        geocoder = new google.maps.Geocoder();
        var center = new google.maps.LatLng(37.9990858, -100.98347380000001);
        console.log(map);
        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 5,
            center: center,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        // Create the search box and link it to the UI element.
        var input = document.getElementById('pac-input');
        var searchBox = new google.maps.places.SearchBox(input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
        map.addListener('bounds_changed', function () {
            searchBox.setBounds(map.getBounds());
        });
        searchBox.addListener('places_changed', function () {
            var places = searchBox.getPlaces();

            if (places.length == 0) {
                return;
            }
            var bounds = new google.maps.LatLngBounds();
            places.forEach(function (place) {
                if (!place.geometry) {
                    console.log("Returned place contains no geometry");
                    return;
                }
                if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                } else {
                    bounds.extend(place.geometry.location);
                }
            });
            map.fitBounds(bounds);
        });
        var infowindow = new google.maps.InfoWindow();
        var mak;
        var e;
        <% @hello.each do |team| %>
        mak = new google.maps.Marker({
            map: map,
            position: new google.maps.LatLng(<%= team.location_lat %>, <%= team.location_long %>),
            title: "<%= team.name %>",
            address: "<%= team.location %>",
            id: "<%= team.id %>"
        });
        markers.push(mak);
        <% end %>
        for (var i = 0; i < markers.length; i++) {
            mak = markers[i];
            mak.addListener('click', (function (makr) {
                return function () {
                    $.ajax({
                        url: "/teams/" + makr.id + "/plain?showlink=true",
                        cache: false,
                        success: function (html) {
                            $("#data-info").html(html);
                        }
                    });
                    realIndex = makr.id;
                    //   console.log(i);
                }
            })(mak));
        }
        var options = {
            imagePath: 'images/m',
            maxZoom: 8
        };
        var markerCluster = new MarkerClusterer(map, markers, options);
    }
</script>

<style >
    #container {
        /*display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      justify-content: space-between; */
        /*background-color: lightyellow;*/
        min-height: 600px;
    }
    #map-container {
        padding: 6px;
        border-width: 1px;
        border-style: solid;
        border-color: #ccc #ccc #999 #ccc;
        -webkit-box-shadow: rgba(64, 64, 64, 0.5) 0 2px 5px;
        -moz-box-shadow: rgba(64, 64, 64, 0.5) 0 2px 5px;
        box-shadow: rgba(64, 64, 64, 0.1) 0 2px 5px;
        /*min-width: 500px;*/
        width: 100%;
        /*width: 500px;*/
        /*max-width: 500px;*/
        height: 600px;
        /*display:inline-block;*/
    }
    #data-container {
        /*width:100%;*/
        /*height:100%;*/
        /*margin: 10px;*/
        /*display:inline-block;*/
        /*min-width: 300px;*/
        /*min-height: 600px;*/
    }
    #map {
        /*height: calc(100%-10px);*/
        height: 585px;
        width: calc(100%);
    }
    .controls {
        margin-top: 10px;
        border: 1px solid transparent;
        border-radius: 2px 0 0 2px;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        height: 32px;
        outline: none;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    }

    #pac-input {
        background-color: #fff;
        font-family: Roboto;
        font-size: 15px;
        font-weight: 300;
        margin-left: 12px;
        padding: 0 11px 0 13px;
        text-overflow: ellipsis;
        width: 300px;
    }
    #pac-input:focus {
        border-color: #4d90fe;
    }

    .pac-container {
        font-family: Roboto;
    }

    #type-selector {
        color: #fff;
        background-color: #4d90fe;
        padding: 5px 11px 0;
    }

    #type-selector label {
        font-family: Roboto;
        font-size: 13px;
        font-weight: 300;
    }
    #target {
        width: 345px;
    }

</style>
